;; org config
;; alf use speedkeys
;;(setq org-use-speed-commands t)



;; ORGMODE
;;
(custom-set-variables
 ;; custom-set-variables was added by Custom.
 ;; If you edit it by hand, you could mess it up, so be careful.
 ;; Your init file should contain only one such instance.
 ;; If there is more than one, they won't work right.
 '(custom-enabled-themes (quote (suscolors)))
 '(custom-safe-themes
   (quote
    ("a7004835dd02c73989032e57574087ec78ce8c2dd0d79f21cdd7423c01d9d2f5" "97d039a52cfb190f4fd677f02f7d03cf7dbd353e08ac8a0cb991223b135ac4e6" default)))
 '(inhibit-startup-screen t)
 '(org-agenda-files
   (quote
    ("/home/alf/org/cloud/mylinux.org" "/home/alf/org/cloud/dashboard.org" "/home/alf/org/cloud/todo.org" "/home/alf/org/cloud/knowledge/emacstest.org" "/home/alf/org/cloud/knowledge/dsa.org" "/home/alf/org/cloud/knowledge/vagrant.org" "/home/alf/org/cloud/knowledge/o2.org" "/home/alf/org/cloud/knowledge/links.org" "/home/alf/org/cloud/knowledge/svganimation.org" "/home/alf/org/cloud/knowledge/gamedev.org" "/home/alf/org/cloud/knowledge/pilze.org" "/home/alf/org/cloud/knowledge/osx.org" "/home/alf/org/cloud/knowledge/server.org" "/home/alf/org/cloud/knowledge/hosted.org" "/home/alf/org/cloud/knowledge/aftereffects.org" "/home/alf/org/cloud/knowledge/synology.org" "/home/alf/org/cloud/knowledge/emacs.org" "/home/alf/org/cloud/knowledge/bookmarks.org" "/home/alf/org/cloud/knowledge/vscode.org" "/home/alf/org/cloud/knowledge/vim-editor.org" "/home/alf/org/cloud/knowledge/macbook.org" "/home/alf/org/cloud/knowledge/webdev.org" "/home/alf/org/cloud/knowledge/mysql.org" "/home/alf/org/cloud/knowledge/ruby.org" "/home/alf/org/cloud/knowledge/auto.org" "/home/alf/org/cloud/knowledge/linux.org" "/home/alf/org/cloud/knowledge/git.org" "/home/alf/org/cloud/knowledge/python.org" "/home/alf/org/cloud/knowledge/contao4.org" "/home/alf/org/cloud/knowledge/orgmode.org" "/home/alf/org/cloud/knowledge/godot.org" "/home/alf/org/cloud/knowledge/boltcms.org" "/home/alf/org/cloud/knowledge/javascript.org" "/home/alf/org/cloud/knowledge/kubernetes.org" "/home/alf/org/cloud/knowledge/golang.org" "/home/alf/org/cloud/knowledge/blender.org" "/home/alf/org/cloud/knowledge/adobe.org" "/home/alf/org/cloud/knowledge/docker.org" "/home/alf/org/cloud/biglist.org" "/home/alf/org/cloud/photos.org" "/home/alf/org/cloud/backup.org" "/home/alf/org/cloud/projects/mpu.org" "/home/alf/org/cloud/projects/hyrtenhaus.de.org" "/home/alf/org/cloud/projects/audioghost.org" "/home/alf/org/cloud/projects/nas_2018.org" "/home/alf/org/cloud/projects/timwedding.org" "/home/alf/org/cloud/projects/babeltest.org" "/home/alf/org/cloud/projects/2018_prj.org" "/home/alf/org/cloud/projects/projects.org" "/home/alf/org/cloud/projects/web_diebergedeswahnsinns.de.org" "/home/alf/org/cloud/projects/web_westernbiological.org" "/home/alf/org/cloud/business/alfredbiz.org" "/home/alf/org/cloud/business/clients/temp.org" "/home/alf/org/cloud/business/clients/gluecklich.org" "/home/alf/org/cloud/business/clients/webseiten.org" "/home/alf/org/cloud/business/clients/ontraq.org" "/home/alf/org/cloud/business/clients/mutik-gmbh.org" "/home/alf/org/cloud/business/clients/rafaelbernardo.org" "/home/alf/org/cloud/business/clients/captaingrafik.org" "/home/alf/org/cloud/business/clients/hbh.org" "/home/alf/org/cloud/business/clients/cdcweb.org" "/home/alf/org/cloud/business/clients/Tillus/tillus.org" "/home/alf/org/cloud/business/clients/pamir.org" "/home/alf/org/cloud/business/clients/nuwave.org" "/home/alf/org/cloud/business/clients/RafaelBernardo/headachehurts.org" "/home/alf/org/cloud/business/clients/RafaelBernardo/leezafive.org" "/home/alf/org/cloud/business/clients/ursberg.org" "/home/alf/org/cloud/business/clients/geiger.org" "/home/alf/org/cloud/business/clients/westwoodbbluegrasband.org" "/home/alf/org/cloud/business/clients/maxkeller.org" "/home/alf/org/cloud/business/clients/fakeclient.org" "/home/alf/org/cloud/business/clients/wup.org" "/home/alf/org/cloud/business/clients/decrignis.org" "/home/alf/org/cloud/business/clients/trailerhaus.org" "/home/alf/org/cloud/business/clients/rookman.org" "/home/alf/org/cloud/business/toniafeegrass.org" "/home/alf/org/cloud/business/tax/_taxes.org" "/home/alf/org/cloud/accounts.org" "/home/alf/org/cloud/accounts_old.org" "/home/alf/org/cloud/simpleaccounts.org" "/home/alf/org/cloud/notes.org" "/home/alf/org/cloud/personal/justiz.org" "/home/alf/org/cloud/personal/rpg.org" "/home/alf/org/cloud/personal/urlaub.org" "/home/alf/org/cloud/personal/hirtenhaus.org" "/home/alf/org/cloud/personal/alpha.org" "/home/alf/org/cloud/personal/journal.org" "/home/alf/org/cloud/personal/christmas.org" "/home/alf/org/cloud/personal/umzug.org" "/home/alf/org/cloud/personal/hia.org" "/home/alf/org/cloud/personal/contacts.org" "/home/alf/org/cloud/personal/privat.org" "/home/alf/org/cloud/personal/boardgames.org" "/home/alf/org/cloud/personal/einkauf.org" "/home/alf/org/cloud/personal/versicherungen.org" "/home/alf/org/cloud/personal/birthdays.org" "/home/alf/org/cloud/personal/habits.org" "/home/alf/org/cloud/system.org")))
 '(org-agenda-show-all-dates t)
 '(org-deadline-warning-days 14)
 '(org-export-backends (quote (ascii html icalendar latex md odt)))
 '(org-log-done (quote note))
 '(org-log-repeat (quote note))
 '(org-super-agenda-mode t)
 '(org-support-shift-select t)
 '(package-selected-packages
   (quote
    (php-mode calfw-org calfw isearch which-key origami org-super-agenda org-mru-clock inf-ruby helm-swoop use-package suscolors-theme smartparens rainbow-mode org-plus-contrib ob-async multishell multiple-cursors helm-org-rifle helm-git-grep god-mode flx-ido eyebrowse diminish)))
 '(rainbow-html-colors t)
 '(rainbow-html-colors-major-mode-list (quote (org-mode css-mode php-mode nxml-mode xml-mode))))


(custom-set-faces
 ;; custom-set-faces was added by Custom.
 ;; If you edit it by hand, you could mess it up, so be careful.
 ;; Your init file should contain only one such instance.
 ;; If there is more than one, they won't work right.
 '(org-level-6 ((t (:inherit outline-6 :foreground "tomato")))))


(setq org-directory (expand-file-name "~/org-notes")
      org-agenda-files (list org-directory)
      org-ellipsis " â–¼ "
      org-babel-python-command "python3")

(require 'org-collector)
;;(require 'org-crypt)
;;(org-crypt-use-before-save-magic)
(setq org-tags-exclude-from-inheritance (quote ("crypt")))
(setq org-crypt-key nil)


(setq org-todo-keywords
      '((sequence "TODO(t)" "PROGRESS(o@/!)" "NEXT(n)" "WAITING(w@/!)" "|" "DONE(d!)" "CANCELLED(c@/!)")
      (sequence "PROJECT(p@!)" "ON HOLD(h!@/!@)" "|" "FINISHED(f!@)" "INACTIVE(i!@/!)")))

(setq org-todo-state-tags-triggers
      (quote (("CANCELLED" ("CANCELLED" . t))
              ("PROJECT" ("WAITING") ("CANCELLED")("PROGRESS") ("PRJ") ("NEXT") ("PRJ" . t) )
              ("WAITING" ("NEXT")("PRJ")("PROGRESS")("WAITING" . t))
              ("PROGRESS" ("NEXT")("PRJ")("WAITING") ("PROGRESS" . t))
              ("NEXT" ("WAITING")("PROGRESS")("PRJ")("NEXT" . t))
              ("FINISHED" ("WAITING")("NEXT")("PROGRESS")("CANCELLED")("FINISHED" . t))
              ("INACTIVE" ("WAITING")("PRJ")("NEXT")("PROGRESS")("CANCELLED" . t)("FINISHED"))
              ("ON HOLD" ("WAITING")("PRJ")("NEXT")("CANCELLED")("FINISHED") ("HOLD" . t))
              (done ("WAITING") ("NEXT") ("PRJ") ("HOLD") )
              ("TODO" ("HOLD")("PROGRESS")("WAITING") ("CANCELLED") ("PRJ") ("NEXT") )
              ("NEXT" ("HOLD")("PROGRESS")("WAITING") ("CANCELLED") ("PRJ") )
              ("DONE" ("HOLD")("PROGRESS")("WAITING") ("CANCELLED") ("PRJ") ("NEXT")))))


;; Orgmode capture templates
(setq org-capture-templates
      (quote (("t" "todo" entry (file+olp "~/org/cloud/dashboard.org" "INCOMING" "TASKS")
               "* TODO %?\n:PROPERTIES:\n:CREATED: %U\n:END:\n%a\n\n\n")
              ("i" "INTERRUPT" entry (file+olp "~/org/cloud/dashboard.org" "INCOMING" "INTERRUPTS")
               "* TODO %?\n:PROPERTIES:\n:CREATED: %U\n:END:\n%a\n" :clock-in t :clock-resume t)
              ("s" "Scheduled todo" entry (file+olp "~/org/cloud/dashboard.org" "INCOMING" "TASKS")
               "* TODO %?\n:SCHEDULED: %t\n:PROPERTIES:\n:CREATED: %U\n:END:\n%a\n\n")
              ("n" "note" entry (file+olp "~/org/cloud/dashboard.org" "INCOMING" "NOTES")
               "* %? :NOTE:\n:PROPERTIES:\n:CREATED: %U\n:END:\n%U\n%a\n" :clock-in t :clock-resume t)
              ("b" "Bookmark" entry (file+olp "~/org/cloud/knowledge/bookmarks.org" "INCOMING")
               "* %? \n%U\n%a\n" :clock-keep t )
              ("j" "Journal" entry (file+olp+datetree "~/org/cloud/personal/journal.org" "log")
               "* %?\n:PROPERTIES:\n:CREATED: %U\n:END:\n%U\n" :clock-in t :clock-resume t)
              ("w" "org-protocol" entry (file+olp "~/org/cloud/dashboard.org" "INCOMING")
               "* TODO Review %c\n%U\n" :immediate-finish t)
              ("r" "Rechnung" entry (file+headline "~/org/cloud/business/alfredbiz.org" "Ausgaben_alle")
               "* TODO %^{PROMPT|Rechungsname} :COST:
:PROPERTIES:
:KONTO: %^{Welches Konto?}
:YEAR: %^{Jahr?}
:MONTH: %^{Monat?}
:ID: %^{ID?}
:NETTO: %^{netto}
:UST: %^{Ust}
:BRUTTO: %^{brutto}
:LINK: [[%^{link to file}][pdf]]
:END: \n%^u\n%
\n%?")
              ("m" "Meeting" entry (file+olp "~/org/cloud/dashboard.org" "INCOMING" "INTERRUPTS")
               "* MEETING with %? :PAUSE:\n:PROPERTIES:\n:CREATED: %U\n:END:\n%U" :clock-in t :clock-resume t)
              ("p" "PAUSE - All thing have a break")
              ("pp" "PAUSE" entry (file+olp "~/org/cloud/dashboard.org" "INCOMING" "BREAKS")
               "* PAUSE with %? :PAUSE:\n%U" :clock-in t :clock-resume t)
              ("pt" "PAUSE ten mins" entry (file+olp "~/org/cloud/dashboard.org" "INCOMING" "BREAKS")
               "* Ten Minute Break with %? :PAUSE:\n%U" :clock-in t :clock-resume t)
              ("pc" "Coffee Break" entry (file+olp "~/org/cloud/dashboard.org" "INCOMING" "BREAKS")
               "* PAUSE with %? :PAUSE:\n%U" :clock-in t :clock-resume t)
              ("pb" "Big Break" entry (file+olp "~/org/cloud/dashboard.org" "INCOMING" "BREAKS")
               "* PAUSE with %? :PAUSE:\n%U" :clock-in t :clock-resume t)

              ("f" "Phone call" entry (file "~/org/cloud/todo.org")
               "* PHONE %? :PHONE:\n%U" :clock-in t :clock-resume t)
              ("h" "Habit" entry (file "~/org/cloud/todo.org")
               "* NEXT %?\n%U\n%a\nSCHEDULED: %(format-time-string \"%<<%Y-%m-%d %a .+1d/3d>>\")\n:PROPERTIES:\n:STYLE: habit\n:REPEAT_TO_STATE: NEXT\n:END:\n"))))





;; Custom agenda command definitions
(setq org-agenda-custom-commands
      (quote (("N" "Notes" tags "NOTE"
               ((org-agenda-overriding-header "Notes")
                (org-tags-match-list-sublevels t)))
              ("h" "Habits" tags-todo "STYLE=\"habit\""
               ((org-agenda-overriding-header "Habits")
                (org-agenda-sorting-strategy
                 '(todo-state-down effort-up category-keep))))


              ("q" "Only Tasks with WORK tag"
               ((agenda "" ((org-agenda-span 1)
                            (org-agenda-start-on-weekday nil)
                            (org-agenda-start-day "0d")
                            (org-agenda-repeating-timestamp-show-all t)
                            (org-agenda-tag-filter-preset '("+WORK"))
                            )
                        ))
               )
              ("u" . "SUPER Agenda")


              ("ux" "SUPER Agenda"
               (

                (tags-todo "+TODO=\"PROGRESS\"" (
                                   (org-super-agenda-groups '(
                                                              (:name "PROGRESS"
                                                                     :order 4)
                                                              )
                                                            )))

                (agenda "" (
                            (org-agenda-span 1)
                            (org-agenda-compact-blocks nil)
                            (org-agenda-start-day "0d")
                            (org-super-agenda-groups '(
                                                       (:name "Today"
                                                              :scheduled today
                                                              :time-grid t
                                                              :order 5
                                                              )
                                                       (:name "In Progress"
                                                              :todo ("PROGRESS")
                                                              :order 10
                                                              )
                                                       (:name "Next Items"
                                                              :tag ("NEXT" "outbox")
                                                              :order 20
                                                              )

                                                       (:name "Urgent"
                                                              :priority "A"
                                                              :order 30
                                                              )

                                                       (:name "Work related"
                                                              :tag ("WORK" "PAID")
                                                              :order 40
                                                              )

                                                       (:name "Privat related"
                                                              :tag ("PRIV" "UNPAID")
                                                              :order 50
                                                              )
                                                       (:name "ORGA related"
                                                              :tag ("ORGA")
                                                              :order 60
                                                              )
                                                       (:name "Projects"
                                                              :todo "PROJECT"
                                                              :order 70
                                                              )

                                                       ))))

                                (tags-todo "+ACTIVE+PRJ+TODO=\"PROJECT\"" (
                                   (org-super-agenda-groups '(
                                                              (:name "Aktive Projekte"
                                                               :order 300)
                                                              )
                                                            )))

                                (tags-todo "NEXT" (
                                   (org-super-agenda-groups '(
                                                              (:name "NEXT"
                                                                     :order 90)
                                                              )
                                                            )))

                            (agenda "" (
                                        (org-agenda-span 14)
                                        (org-agenda-compact-blocks nil)
                                        (org-agenda-start-on-weekday nil)
                            (org-agenda-start-day "+1d")
                            (org-super-agenda-groups '(
                                                       (:auto-category t
                                                              :order 1
                                                              )

                                                       ))))




                ))



              ("ui" "SUPER Projects"
               (
                (tags-todo "+ACTIVE+PRJ+TODO=\"PROJECT\"" (
                                   (org-super-agenda-groups '(
                                                              (:name "Aktive Projekte"
                                                               :order 100)
                                                              )
                                                            ))
                           )
                (tags-todo "NEXT" (
                                   (org-super-agenda-groups '(
                                                              (:name "NEXT"
                                                               :order 90)
                                                              )
                                                            ))
                           )
                (tags-todo "+INACTIVE+PRJ+TODO=\"PROJECT\"" (
                                   (org-super-agenda-groups '(
                                                              (:name "Inaktive Projekte"
                                                               :order 10)
                                                              )
                                                            ))
                           )

                (tags-todo "+PRJ+TODO=\"PROJECT\"" (
                                                    (org-super-agenda-groups '(
                                                                               (
                                                                                :name "Alle anderen Projekte"
                                                                                :auto-category t
                                                                                :order 60
                                                                                )
                                                                               )))))
               )

              ("All" "w Active Projects" ((tags-todo "+PRJ+TODO=\"PROJECT\"") (todo "NEXT")
                                          ))

              ("Y" "Agenda"
               ((agenda "" nil)
                (tags "REFILE"
                      ((org-agenda-overriding-header "Tasks to Refile")
                       (org-tags-match-list-sublevels nil)))
                (tags-todo "-CANCELLED/!"
                           ((org-agenda-overriding-header "Stuck Projects")
                            (org-agenda-skip-function 'bh/skip-non-stuck-projects)
                            (org-agenda-sorting-strategy
                             '(category-keep))))
                (tags-todo "-HOLD-CANCELLED/!"
                           ((org-agenda-overriding-header "Projects")
                            (org-agenda-skip-function 'bh/skip-non-projects)
                            (org-tags-match-list-sublevels 'indented)
                            (org-agenda-sorting-strategy
                             '(category-keep))))
                (tags-todo "-CANCELLED/!NEXT"
                           ((org-agenda-overriding-header (concat "Project Next Tasks"
                                                                  (if bh/hide-scheduled-and-waiting-next-tasks
                                                                      ""
                                                                    " (including WAITING and SCHEDULED tasks)")))
                            (org-agenda-skip-function 'bh/skip-projects-and-habits-and-single-tasks)
                            (org-tags-match-list-sublevels t)
                            (org-agenda-todo-ignore-scheduled bh/hide-scheduled-and-waiting-next-tasks)
                            (org-agenda-todo-ignore-deadlines bh/hide-scheduled-and-waiting-next-tasks)
                            (org-agenda-todo-ignore-with-date bh/hide-scheduled-and-waiting-next-tasks)
                            (org-agenda-sorting-strategy
                             '(todo-state-down effort-up category-keep))))
                (tags-todo "-REFILE-CANCELLED-WAITING-HOLD/!"
                           ((org-agenda-overriding-header (concat "Project Subtasks"
                                                                  (if bh/hide-scheduled-and-waiting-next-tasks
                                                                      ""
                                                                    " (including WAITING and SCHEDULED tasks)")))
                            (org-agenda-skip-function 'bh/skip-non-project-tasks)
                            (org-agenda-todo-ignore-scheduled bh/hide-scheduled-and-waiting-next-tasks)
                            (org-agenda-todo-ignore-deadlines bh/hide-scheduled-and-waiting-next-tasks)
                            (org-agenda-todo-ignore-with-date bh/hide-scheduled-and-waiting-next-tasks)
                            (org-agenda-sorting-strategy
                             '(category-keep))))
                (tags-todo "-REFILE-CANCELLED-WAITING-HOLD/!"
                           ((org-agenda-overriding-header (concat "Standalone Tasks"
                                                                  (if bh/hide-scheduled-and-waiting-next-tasks
                                                                      ""
                                                                    " (including WAITING and SCHEDULED tasks)")))
                            (org-agenda-skip-function 'bh/skip-project-tasks)
                            (org-agenda-todo-ignore-scheduled bh/hide-scheduled-and-waiting-next-tasks)
                            (org-agenda-todo-ignore-deadlines bh/hide-scheduled-and-waiting-next-tasks)
                            (org-agenda-todo-ignore-with-date bh/hide-scheduled-and-waiting-next-tasks)
                            (org-agenda-sorting-strategy
                             '(category-keep))))
                (tags-todo "-CANCELLED+WAITING|HOLD/!"
                           ((org-agenda-overriding-header (concat "Waiting and Postponed Tasks"
                                                                  (if bh/hide-scheduled-and-waiting-next-tasks
                                                                      ""
                                                                    " (including WAITING and SCHEDULED tasks)")))
                            (org-agenda-skip-function 'bh/skip-non-tasks)
                            (org-tags-match-list-sublevels nil)
                            (org-agenda-todo-ignore-scheduled bh/hide-scheduled-and-waiting-next-tasks)
                            (org-agenda-todo-ignore-deadlines bh/hide-scheduled-and-waiting-next-tasks)))
                (tags "-REFILE/"
                      ((org-agenda-overriding-header "Tasks to Archive")
                       (org-agenda-skip-function 'bh/skip-non-archivable-tasks)
                       (org-tags-match-list-sublevels nil))))
               nil))))


;; Super agenda config kram
(setq org-agenda-window-setup (quote current-window))

;; ALF Save recent clocked tasks
(setq org-clock-persist t)
(setq org-clock-persist-file "~/org-clock/org-clock-save.el")
;; (org-clock-persistence-insinuate)

(setq org-log-done 'note)
(setq org-log-into-drawer t)
(setq org-treat-insert-todo-heading-as-state-change t)


;; Log clock out with note
(setq org-log-note-clock-out t)

;; Log reschedule and redeadline
(setq org-log-reschedule (quote time))
(setq org-log-redeadline (quote time))

;; log done state
(setq org-log-done (quote time))
;; columns view agenda
;;(setq org-columns-default-format "%20ITEM(Task) %1PRIORITY %TAGS(Tags) %6TODO %4EFFORT{:} %4CLOCKSUM")
(setq org-overriding-columns-format "%CATEGORY %50ITEM(Task) %1PRIORITY %TAGS(Tags) %6TODO %4EFFORT{:} %4CLOCKSUM")
(setq org-agenda-columns-add-appointments-to-effort-sum t)
(setq org-agenda-default-appointment-duration 60)



(org-babel-do-load-languages
 'org-babel-load-languages
 ; load all language marked with (lang . t).
 '((C . t)
   (R . t)

   (awk .t)
   (calc)
   (clojure)
   (comint)
   (css)
   (ditaa . t)
   (dot . t)
   (emacs-lisp . t)

   (gnuplot . t)
   (haskell)
   (io)
   (java)
   (js .t)
   (latex)
   (ledger)

   (lisp .t)

   (maxima)
   (mscgen)
   (ocaml)
   (octave)
   (org . t)
   (perl)
   (picolisp)
   (plantuml)
   (python . t)
   (ref)
   (ruby . t)
   (php . t)
   (scala)
   (scheme)

   (shell . t)
   (shen)
   (sql)
   (sqlite)))

;;Org mode hook for visual lines

(add-hook 'org-mode-hook (lambda()
                          (visual-line-mode)
                          ))

(setq org-duration-format (quote h:mm))
